<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="2160" viewBox="43 -1124 15040 26942"><g fill="none" stroke="#000" stroke-width="2.4"><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4771 4110 6519 4110 6519 4771 4771 4771 4771 4110"/><text x="5574" y="4393" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">examine isa_xchg</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5763 5385 7511 5385 7511 6047 5763 6047 5763 5385"/><text x="6566" y="5669" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">find/create state</text><text x="6566" y="5905" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">object</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4771 6661 6519 6661 6519 7322 4771 7322 4771 6661"/><text x="5574" y="6944" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">determine valid</text><text x="5622" y="7181" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">transitions</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4771 7984 6519 7984 6519 8645 4771 8645 4771 7984"/><text x="5574" y="8267" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">verify state</text><text x="5622" y="8503" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">is not suspended</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4771 9354 6519 9354 6519 10015 4771 10015 4771 9354"/><text x="5574" y="9637" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">decrypt packet</text><text x="5622" y="9874" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">if appropriate</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4771 10724 6519 10724 6519 11385 4771 11385 4771 10724"/><text x="5574" y="11007" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">calculate hash</text><text x="5622" y="11244" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">if appropriate</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5102 10015 5102 10551"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="5039 10279 5102 10594 5165 10279 5102 10342"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5102 11385 5102 11921"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="5039 11649 5102 11964 5165 11649 5102 11712"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4771 12094 6519 12094 6519 12755 4771 12755 4771 12094"/><text x="5574" y="12377" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">enforce ordering</text><text x="5622" y="12614" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">of payloads</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="3732 13653 5480 13653 5480 14314 3732 14314 3732 13653"/><text x="4535" y="13937" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">state specific func</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4062 14314 4062 14850"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="3999 14578 4062 14893 4125 14578 4062 14641"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="3732 15023 5480 15023 5480 15685 3732 15685 3732 15023"/><text x="4535" y="15307" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">complete_state_</text><text x="4582" y="15543" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">transition()</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5338 16488 7086 16488 7086 17149 5338 17149 5338 16488"/><text x="6141" y="16771" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">STF_IGNORE</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5338 17858 7086 17858 7086 18519 5338 18519 5338 17858"/><text x="6141" y="18141" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">STF_SUSPEND</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5338 19370 7086 19370 7086 20031 5338 20031 5338 19370"/><text x="6141" y="19653" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">STF_OK</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5338 20929 7086 20929 7086 21590 5338 21590 5338 20929"/><text x="6141" y="21212" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">STF_FATAL</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5338 22393 7086 22393 7086 23055 5338 23055 5338 22393"/><text x="6141" y="22677" fill="#000" font-family="Times" font-size="101" font-style="normal" font-weight="normal" text-anchor="middle">STF_INTERNAL_ERROR</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5338 25133 7086 25133 7086 25795 5338 25795 5338 25133"/><text x="6141" y="25417" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">STF_FAIL</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5338 23669 7086 23669 7086 24330 5338 24330 5338 23669"/><text x="6141" y="23952" fill="#000" font-family="Times" font-size="89" font-style="normal" font-weight="normal" text-anchor="middle">STF_TOO_MUCH_CRYPTO</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="8314 20078 10062 20078 10062 20740 8314 20740 8314 20078"/><text x="9118" y="20362" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">send_packet()</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="7086 13653 8834 13653 8834 14314 7086 14314 7086 13653"/><text x="7889" y="13937" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">encrypt packet</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="992 13653 2740 13653 2740 14314 992 14314 992 13653"/><text x="1795" y="13937" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">continuation</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="3732 -141 5480 -141 5480 519 3732 519 3732 -141"/><text x="4535" y="141" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">read_packet()</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="3732 1275 5480 1275 5480 1937 3732 1937 3732 1275"/><text x="4535" y="1559" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">process_packet()</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4771 2692 8078 2692 8078 3354 4771 3354 4771 2692"/><text x="6330" y="3118" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">de-marshal payloads (in_struct)</text><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="1984 1842 1984 5401"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="1921 5129 1984 5444 2047 5129 1984 5192"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5102 1937 5102 2566"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="5039 2295 5102 2609 5165 2295 5102 2358"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5102 7322 5102 7858"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="5039 7586 5102 7901 5165 7586 5102 7649"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5102 8645 5102 9181"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="5039 8909 5102 9224 5165 8909 5102 8972"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4062 1937 4062 13480"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="3999 13208 4062 13523 4125 13208 4062 13271"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="4251 15685 4251 16771 5212 16771"/><polygon fill="#fff" stroke="#000" stroke-width="16" points="5179 16803 5304 16771 5179 16740"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="4251 15685 4251 18188 5212 18188"/><polygon fill="#fff" stroke="#000" stroke-width="16" points="5179 18220 5304 18188 5179 18157"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="4251 18755 4251 21259 5212 21259"/><polygon fill="#fff" stroke="#000" stroke-width="16" points="5179 21291 5304 21259 5179 21228"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="4251 20173 4251 22677 5212 22677"/><polygon fill="#fff" stroke="#000" stroke-width="16" points="5179 22708 5304 22677 5179 22645"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="4251 21496 4251 23999 5212 23999"/><polygon fill="#fff" stroke="#000" stroke-width="16" points="5179 24031 5304 23999 5179 23968"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="4251 22960 4251 25464 5212 25464"/><polygon fill="#fff" stroke="#000" stroke-width="16" points="5179 25496 5304 25464 5179 25433"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="4251 17149 4251 19653 5212 19653"/><polygon fill="#fff" stroke="#000" stroke-width="16" points="5179 19685 5304 19653 5179 19622"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="6425 20031 6425 20362 8188 20362"/><polygon fill="#fff" stroke="#000" stroke-width="16" points="8155 20393 8281 20362 8155 20330"/><polyline stroke="#000" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="5480 13795 6960 13795"/><polygon fill="#fff" stroke="#000" stroke-width="16" points="6927 13826 7053 13795 6927 13763"/><polyline stroke="#000" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="7039 14173 5606 14173"/><polygon fill="#fff" stroke="#000" stroke-width="16" points="5639 14141 5513 14173 5639 14204"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="2740 13889 3606 13889"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="3334 13952 3649 13889 3334 13826 3397 13889"/><polyline stroke="#000" stroke-dasharray="10 10 10" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5291 18425 1559 18425 1559 14566"/><polygon fill="#000" stroke="#000" stroke-width="32" points="1622 14635 1559 14383 1496 14635"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4535 -850 4535 -313"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="4472 -585 4535 -270 4598 -585 4535 -522"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="4535 519 4535 1149"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="4472 877 4535 1192 4598 877 4535 940"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5102 4771 5102 6535"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="5039 6263 5102 6578 5165 6263 5102 6326"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="6141 4771 6141 5259"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="6078 4987 6141 5302 6204 4987 6141 5050"/><polyline stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="32" points="5149 3354 5109 3984"/><polygon fill="#fff" stroke="#000" stroke-width="32" points="5063 3708 5107 4027 5189 3716 5122 3775"/><text x="3307" y="1653" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="end">msg_digest populated</text><text x="2173" y="5622" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="start">md-&gt;st connected</text><text x="4440" y="14645" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="start">returns STF_*</text><text x="1464" y="15590" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="end">DNS lookup</text><text x="1464" y="15858" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="end">DH calculation</text><text x="1464" y="16125" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="end">g^x calculation</text><text x="1464" y="16393" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="end">(LDAP lookup)</text><text x="1464" y="16661" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="end">(RSA sig check)</text><text x="1464" y="16929" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="end">(radius/pam)</text><text x="7275" y="18188" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="start">md -&gt; st-&gt;st_suspended_md</text><text x="8787" y="20929" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="start">md freed</text><text x="5196" y="-944" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">Time Sequence diagram of packet receive in Pluto</text><text x="4724" y="-566" fill="#000" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="start">select() indicates fd read</text><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="9448 3354 12094 3354 12094 4015 9448 4015 9448 3354"/><text x="10913" y="3779" fill="red" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">proc recvRawMessage</text><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8314 9921 10960 9921 10960 10582 8314 10582 8314 9921"/><text x="9779" y="10346" fill="red" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">proc recvMessage</text><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8314 12755 10960 12755 10960 13417 8314 13417 8314 12755"/><text x="9779" y="13181" fill="red" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">proc changeState</text><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8267 14551 10913 14551 10913 15212 8267 15212 8267 14551"/><text x="9732" y="14976" fill="red" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">proc outgoingClearText</text><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="12425 20220 15070 20220 15070 20881 12425 20881 12425 20220"/><text x="13889" y="20645" fill="red" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">proc sixtySeconds</text><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8314 19039 10960 19039 10960 19700 8314 19700 8314 19039"/><text x="9779" y="19464" fill="red" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">proc avoidEmitting</text><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8314 15685 10960 15685 10960 16346 8314 16346 8314 15685"/><text x="9779" y="16110" fill="red" font-family="Times" font-size="152" font-style="normal" font-weight="normal" text-anchor="middle">proc adjustFailure</text><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8078 2881 9921 2881 9921 3322"/><polyline stroke="red" stroke-width="16" points="9889 3193 9921 3319 9952 3193"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="9496 3732 6236 3732 6236 4078"/><polyline stroke="red" stroke-width="16" points="6204 3949 6236 4075 6267 3949"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="6519 9637 8787 9637 8787 9889"/><polyline stroke="red" stroke-width="16" points="8755 9760 8787 9886 8818 9760"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8787 10582 8787 11574 5133 11574"/><polyline stroke="red" stroke-width="16" points="5262 11543 5137 11574 5262 11606"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="4062 12897 8283 13038"/><polyline stroke="red" stroke-width="16" points="8153 13064 8280 13038 8155 13002"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8314 13181 4488 13322 4488 13622"/><polyline stroke="red" stroke-width="16" points="4456 13492 4488 13618 4519 13492"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="7842 14362 7842 14834 8236 14834"/><polyline stroke="red" stroke-width="16" points="8107 14866 8233 14834 8107 14803"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8267 14976 7511 14976 7511 14393"/><polyline stroke="red" stroke-width="16" points="7543 14522 7511 14396 7480 14522"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="10913 14881 13889 14881 13889 20188"/><polyline stroke="red" stroke-width="16" points="13858 20059 13889 20185 13921 20059"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="11007 16015 13228 16015 13228 20188"/><polyline stroke="red" stroke-width="16" points="13196 20059 13228 20185 13259 20059"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="11007 19370 12944 19370 12944 20188"/><polyline stroke="red" stroke-width="16" points="12913 20059 12944 20185 12976 20059"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="12425 20456 10094 20456"/><polyline stroke="red" stroke-width="16" points="10223 20425 10097 20456 10223 20488"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="7606 20456 7606 19370 8283 19324"/><polyline stroke="red" stroke-width="16" points="8156 19363 8280 19324 8152 19301"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8314 19464 7842 19464 7888 20377"/><polyline stroke="red" stroke-width="16" points="7849 20249 7887 20374 7911 20246"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="8314 16110 4283 16298"/><polyline stroke="red" stroke-width="16" points="4410 16259 4286 16297 4413 16322"/><polyline stroke="red" stroke-dasharray="50 50" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="16" points="4251 15968 8283 15968"/><polyline stroke="red" stroke-width="16" points="8154 15999 8280 15968 8154 15937"/></g></svg>