<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="svg2" width="1632" height="2112" version="1.0"><defs id="defs4"><linearGradient id="linearGradient5965"><stop id="stop5967" offset="0" stop-color="#000" stop-opacity="1"/><stop id="stop5969" offset="1" stop-color="#000" stop-opacity="0"/></linearGradient><linearGradient id="linearGradient5971" x1="116.464" x2="122.906" y1="-35.127" y2="12.997" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient5965"/><linearGradient id="linearGradient5989" x1="116.464" x2="85.771" y1="-35.127" y2="-8.223" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient5965"/></defs><g id="layer1" display="inline"><g id="g6148" transform="translate(11.75,7.467917)"><rect id="rect5902" width="210" height="540" x="40" y="42.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text5918" x="124.482" y="55.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan5920" x="124.482" y="55.506">ipssec_rcv()</tspan></text></g><g id="g5949" display="inline" transform="translate(31.75,28.09292)"><rect id="rect5951" width="190" height="20" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text5953" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan5955" x="124.613" y="65.506">ipssec_rcv_state_new()</tspan></text></g><g id="g5991" display="inline" transform="translate(31.75,58.09292)"><rect id="rect5993" width="190" height="20" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text5995" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan5997" x="124.613" y="65.506">ipsec_rcv_natt_decap()</tspan></text></g><g id="g6003" display="inline" transform="translate(31.75,88.09292)"><rect id="rect6005" width="190" height="20" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6007" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6009" x="124.613" y="65.506" font-style="italic">store hard_header</tspan></text></g><g id="g6011" display="inline" transform="translate(31.75,118.0929)"><rect id="rect6013" width="190" height="20" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6015" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6017" x="124.613" y="65.506">ipsec_rcv_unclone()</tspan></text></g><g id="g6019" display="inline" transform="translate(31.75,148.0929)"><rect id="rect6021" width="190" height="20" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6023" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6025" x="124.613" y="65.506">skb_linearize()</tspan></text></g><g id="g6027" display="inline" transform="translate(31.75,178.0929)"><rect id="rect6029" width="190" height="50" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6031" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6033" x="124.613" y="65.506" font-style="italic">if(natt)</tspan></text></g><g id="g6035" display="inline" transform="translate(31.75,238.0929)"><rect id="rect6037" width="190" height="20" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6039" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6041" x="124.613" y="65.506" font-style="italic">decode header</tspan></text></g><g id="g6043" display="inline" transform="translate(31.75,268.0929)"><rect id="rect6045" width="190" height="20" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6047" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6049" x="124.613" y="65.506" font-style="italic">find ipsecX device</tspan></text></g><g id="g6051" display="inline" transform="translate(31.75,298.0929)"><rect id="rect6053" width="190" height="20" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6055" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6057" x="124.613" y="65.506" font-style="italic">prepare for decap loop</tspan></text></g><g id="g6059" display="inline" transform="translate(19.875,328.0929)"><rect id="rect6061" width="190" height="110" x="40" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6063" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6065" x="124.613" y="65.506">__ipsec_tunnel_finish()</tspan></text></g><g id="g6153" display="inline" transform="translate(31.75,477.0128)"><rect id="rect6155" width="190" height="20" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6157" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6159" x="124.613" y="65.506">ipsec_kfree_skb()</tspan></text></g><g id="g6161" display="inline" transform="translate(31.75,507.0128)"><rect id="rect6163" width="190" height="20" x="30" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6165" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6167" x="124.613" y="65.506">ipsec_rcv_state_delete()</tspan></text></g><text id="text6169" x="60.5" y="519.83" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-family="Bitstream Vera Sans" font-size="12" font-style="normal" font-weight="normal" xml:space="preserve"><tspan id="tspan6171" x="60.5" y="519.83" font-style="italic">on error:</tspan></text><g id="g6173" display="inline" transform="translate(310.5,-1.907083)"><rect id="rect6175" width="270" height="700" x="-10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6177" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6179" x="124.613" y="65.506">ipsec_rcv_decap()</tspan></text></g><g id="g6197" display="inline" transform="translate(29.875,348.0929)"><rect id="rect6199" width="170" height="20" x="40" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6201" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6203" x="124.613" y="65.506" font-weight="bold">ipsec_rcv_decap()</tspan></text></g><g id="g6237" display="inline" transform="translate(31.75,198.0929)"><rect id="rect6239" width="170" height="20" x="40" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6241" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6243" x="124.613" y="65.506" font-style="italic">prepare for ESP</tspan></text></g><g id="g6245" display="inline" transform="translate(29.875,398.0929)"><rect id="rect6247" width="150" height="20" x="50" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6249" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6251" x="124.613" y="65.506">ipsec_rcv_state_delete()</tspan></text></g><g id="g6257" display="inline" transform="translate(29.875,378.0929)"><rect id="rect6259" width="170" height="50" x="40" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6261" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6263" x="124.613" y="65.506" font-style="italic">if(natt)</tspan></text></g><path id="path6265" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1" d="M 240,410 C 280,410 280,410 280,390 C 280,355.58602 280,124.35675 280,80 C 280,60 280,60 300,60" display="inline"/><g id="g6181" display="inline" transform="translate(310.5,28.09292)"><rect id="rect6183" width="250" height="80" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6185" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6187" x="124.613" y="65.506">while (ESP or AH)</tspan></text></g><g id="g6189" display="inline" transform="translate(310.5,48.09292)"><rect id="rect6191" width="230" height="20" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6193" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6195" x="124.613" y="65.506" font-style="italic">set proto_funcs</tspan></text></g><g id="g6205" display="inline" transform="translate(310.5,118.0929)"><rect id="rect6207" width="250" height="50" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6209" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6211" x="124.613" y="65.506" font-style="italic">if next is IPComp</tspan></text></g><g id="g6213" display="inline" transform="translate(310.5,78.09292)"><rect id="rect6215" width="230" height="20" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6217" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6219" x="124.613" y="65.506" font-weight="bold">ipsec_rcv_decap_once()</tspan></text></g><g id="g6221" display="inline" transform="translate(310.5,138.0929)"><rect id="rect6223" width="230" height="20" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6225" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6227" x="124.613" y="65.506" font-style="italic">prepare header</tspan></text></g><g id="g6229" display="inline" transform="translate(310.5,198.0929)"><rect id="rect6231" width="230" height="20" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6233" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6235" x="124.613" y="65.506" font-style="italic">correct checksum, etc.</tspan></text></g><g id="g6297" display="inline" transform="translate(310.5,176.8429)"><rect id="rect6299" width="250" height="50" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6301" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6303" x="124.613" y="65.506" font-style="italic">if natt</tspan></text></g><g id="g6305" display="inline" transform="translate(310.5,236.8429)"><rect id="rect6307" width="250" height="50" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6309" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6311" x="124.613" y="65.506" font-style="italic">if next header</tspan></text></g><g id="g6313" display="inline" transform="translate(310.5,318.0929)"><rect id="rect6315" width="230" height="20" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6317" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6319" x="124.613" y="65.506" font-style="italic">do IPIP decap</tspan></text></g><g id="g6321" display="inline" transform="translate(310.5,258.0929)"><rect id="rect6323" width="230" height="20" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6325" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6327" x="124.613" y="65.506" font-style="italic">do policy checks</tspan></text></g><g id="g6329" display="inline" transform="translate(309.875,298.0929)"><rect id="rect6331" width="250" height="110" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6333" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6335" x="124.613" y="65.506" font-style="italic">if packet is IPIP</tspan></text></g><g id="g6345" display="inline" transform="translate(309.875,348.0929)"><rect id="rect6347" width="230" height="20" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6349" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6351" x="124.613" y="65.506" font-style="italic">do policy checks</tspan></text></g><g id="g6357" display="inline" transform="translate(311.125,378.0929)"><rect id="rect6359" width="230" height="20" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6361" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6363" x="124.613" y="65.506" font-style="italic">set nfmark</tspan></text></g><g id="g6369" display="inline" transform="translate(311.125,418.0929)"><rect id="rect6371" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6373" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6375" x="124.613" y="65.506" font-style="italic">restore hard_header</tspan></text></g><g id="g6377" display="inline" transform="translate(310.5,498.0929)"><rect id="rect6379" width="230" height="20" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6381" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6383" x="124.613" y="65.506" font-style="normal">skb_decompress()</tspan></text></g><g id="g6385" display="inline" transform="translate(310.5,448.0929)"><rect id="rect6387" width="250" height="80" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6389" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6391" x="124.613" y="65.506" font-style="italic">if packet is IPComp</tspan></text></g><g id="g6397" display="inline" transform="translate(309.875,468.0929)"><rect id="rect6399" width="230" height="20" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6401" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6403" x="124.613" y="65.506" font-style="italic">do policy checks</tspan></text></g><g id="g6405" display="inline" transform="translate(310.5,536.8429)"><rect id="rect6407" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6409" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6411" x="124.613" y="65.506" font-style="italic">finalize skb pointers</tspan></text></g><g id="g6413" display="inline" transform="translate(311.125,566.8429)"><rect id="rect6415" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6417" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6419" x="124.613" y="65.506" font-style="italic">reset conntrack data</tspan></text></g><g id="g6421" display="inline" transform="translate(311.125,598.0929)"><rect id="rect6423" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6425" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6427" x="124.613" y="65.506" font-style="normal">netif_rx()</tspan></text></g><g id="g6429" display="inline" transform="translate(310.5,648.0929)"><rect id="rect6431" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6433" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6435" x="124.613" y="65.506">ipsec_kfree_skb()</tspan></text></g><text id="text6437" x="309.25" y="690.91" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-style="normal" font-weight="normal" xml:space="preserve"><tspan id="tspan6439" x="309.25" y="690.91" font-style="italic">on error:</tspan></text><g id="g6446" display="inline" transform="translate(620.625,-1.737183)"><rect id="rect6448" width="270" height="727.638" x="-10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6450" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6452" x="124.613" y="65.506">ipsec_rcv_decap_once()</tspan></text></g><path id="path6460" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1" d="M 550,140 C 590,140 590,140 590,120 C 590,112.1175 590,89.375 590,80 C 590,60 590,60 610,60"/><g id="g6464" display="inline" transform="translate(620.625,27.01282)"><rect id="rect6466" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6468" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6470" x="124.613" y="65.506" font-style="italic">parse header and setup state vars</tspan></text></g><g id="g7474"><g id="g6476" display="inline" transform="translate(620.625,58.26282)"><rect id="rect6478" width="250" height="67.638" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6480" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6482" x="124.613" y="65.506" font-style="normal">proto_funcs-&gt;rcv_checks()</tspan></text></g><rect id="rect6486" width="230.625" height="39.375" x="629.375" y="130" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text6488" x="774.953" y="144.715" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan6490" x="774.953" y="144.715" font-style="normal">ipsec_rcv_ah_checks()</tspan></text><text id="text6492" x="774.953" y="162.947" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan6494" x="774.953" y="162.947" font-style="normal">ipsec_rcv_esp_checks()</tspan></text><path id="path6499" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 689.5,130.5 C 689.5,150.5 689.5,170.5 689.5,170.5"/><path id="path7374" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 860,150 C 830,150 690,150 690,150" display="inline"/><text id="text7376" x="660.217" y="145.946" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7378" x="660.217" y="145.946" font-style="italic">case AH:</tspan></text><text id="text7380" x="660.375" y="164.177" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7382" x="660.375" y="164.177" font-style="italic">case ESP:</tspan></text><path id="path7384" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 690,150 C 660,150 630,150 630,150" display="inline"/></g><g id="g7386" display="inline" transform="translate(620.625,138.2628)"><rect id="rect7388" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7390" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7392" x="124.613" y="65.506" font-style="italic">update state vars</tspan></text></g><g id="g7394" display="inline" transform="translate(619.375,168.2628)"><rect id="rect7396" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7398" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7400" x="124.613" y="65.506" font-style="normal">ipsec_sa_getbyid()</tspan></text></g><g id="g7410" display="inline" transform="translate(620.625,198.2628)"><rect id="rect7412" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7414" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7416" x="124.613" y="65.506" font-style="italic">SA state, policy and lifetime checks</tspan></text></g><g id="g7434" display="inline" transform="translate(620.625,228.2628)"><rect id="rect7436" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7438" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7440" x="124.613" y="65.506" font-style="italic">update state vars</tspan></text></g><g id="g7500"><g id="g7442" display="inline" transform="translate(620.625,257.7628)"><rect id="rect7444" width="250" height="67.638" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7446" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7448" x="124.613" y="65.506" font-style="normal">proto_funcs-&gt;rcv_setup_auth()</tspan></text></g><rect id="rect7450" width="230.625" height="39.375" x="629.375" y="329.5" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline"/><text id="text7452" x="774.953" y="344.215" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7454" x="774.953" y="344.215" font-style="normal">ipsec_rcv_ah_setup_auth()</tspan></text><text id="text7456" x="774.953" y="362.447" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7458" x="774.953" y="362.447" font-style="normal">ipsec_rcv_esp_setup_auth()</tspan></text><path id="path7460" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 689.5,330 C 689.5,350 689.5,370 689.5,370" display="inline"/><path id="path7462" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 860,349.5 C 830,349.5 690,349.5 690,349.5" display="inline"/><text id="text7464" x="660.217" y="345.446" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7466" x="660.217" y="345.446" font-style="italic">case AH:</tspan></text><text id="text7468" x="660.375" y="363.677" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7470" x="660.375" y="363.677" font-style="italic">case ESP:</tspan></text><path id="path7472" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 690,349.5 C 660,349.5 630,349.5 630,349.5" display="inline"/></g><g id="g7492" display="inline" transform="translate(620,338.2628)"><rect id="rect7494" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7496" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7498" x="124.613" y="65.506" font-style="normal">ipsec_checkreplaywindow()</tspan></text></g><g id="g7526" display="inline" transform="translate(0,110.5)"><g id="g7528" display="inline" transform="translate(620.625,257.7628)"><rect id="rect7530" width="250" height="67.638" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7532" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7534" x="124.613" y="65.506" font-style="normal">proto_funcs-&gt;rcv_calc_auth()</tspan></text></g><rect id="rect7536" width="230.625" height="39.375" x="629.375" y="329.5" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline"/><text id="text7538" x="774.953" y="344.215" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7540" x="774.953" y="344.215" font-style="normal">ipsec_rcv_ah_calc_auth()</tspan></text><text id="text7542" x="774.953" y="362.447" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7544" x="774.953" y="362.447" font-style="normal">ipsec_rcv_esp_calc_auth()</tspan></text><path id="path7546" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 689.5,330 C 689.5,350 689.5,370 689.5,370" display="inline"/><path id="path7548" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 860,349.5 C 830,349.5 690,349.5 690,349.5" display="inline"/><text id="text7550" x="660.217" y="345.446" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7552" x="660.217" y="345.446" font-style="italic">case AH:</tspan></text><text id="text7554" x="660.375" y="363.677" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7556" x="660.375" y="363.677" font-style="italic">case ESP:</tspan></text><path id="path7558" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 690,349.5 C 660,349.5 630,349.5 630,349.5" display="inline"/></g><g id="g7560" display="inline" transform="translate(620.625,447.0128)"><rect id="rect7562" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7564" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7566" x="124.613" y="65.506" font-style="italic">test digest result and replay window</tspan></text></g><g id="g7568" display="inline" transform="translate(620.625,478.2628)"><rect id="rect7570" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7572" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7574" x="124.613" y="65.506" font-style="normal">ipsec_updatereplaywindow()</tspan></text></g><g id="g7664"><g id="g7582" display="inline" transform="translate(620.625,508.2628)"><rect id="rect7584" width="250" height="87.638" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7586" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7588" x="124.613" y="65.506" font-style="normal">proto_funcs-&gt;rcv_decrypt()</tspan></text></g><rect id="rect7590" width="230.625" height="60" x="629.375" y="580" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline"/><text id="text7592" x="774.953" y="594.715" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7594" x="774.953" y="594.715" font-style="normal">ipsec_rcv_ah_decap()</tspan></text><text id="text7596" x="774.953" y="612.947" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7598" x="774.953" y="612.947" font-style="normal">ipsec_rcv_esp_decrypt()</tspan></text><path id="path7600" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 689.5,580.5 C 689.5,600.5 690,640 690,640" display="inline"/><path id="path7602" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 860,600 C 830,600 690,600 690,600" display="inline"/><text id="text7604" x="660.217" y="595.946" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7606" x="660.217" y="595.946" font-style="italic">case AH:</tspan></text><text id="text7608" x="660.217" y="614.177" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-family="Bitstream Vera Sans" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:125%"><tspan id="tspan7610" x="660.217" y="614.177" font-style="italic">case ESP:</tspan></text><path id="path7612" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 690,600 C 660,600 630,600 630,600" display="inline"/><path id="path7632" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 860,620.5 C 830,620.5 690,620.5 690,620.5" display="inline"/><path id="path7634" fill="none" fill-opacity=".75" fill-rule="evenodd" stroke="#000" stroke-dasharray="1 1" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1" d="M 690,620.5 C 660,620.5 630,620.5 630,620.5" display="inline"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7636" x="712.617" y="587.518" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-size="11.117" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" transform="scale(0.926425,1.079419)" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7638" x="712.617" y="587.518" font-style="italic">case COMP:</tspan></text><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:100%" id="text7640" x="813.748" y="603.778" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" display="inline" font-size="11.428" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" transform="scale(0.952331,1.050055)" writing-mode="lr-tb" xml:space="preserve"><tspan font-style="normal" style="text-align:center;line-height:100%" id="tspan7642" x="813.748" y="603.778" font-family="Bitstream Vera Sans" font-size="11.428" font-stretch="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb">ipsec_rcv_ipcomp_decomp()</tspan></text></g><g id="g7644" display="inline" transform="translate(620.625,607.0128)"><rect id="rect7646" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7648" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7650" x="124.613" y="65.506" font-style="italic">update state and cleanup</tspan></text></g><g id="g7652" display="inline" transform="translate(619.375,638.2628)"><rect id="rect7654" width="250" height="20" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7656" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7658" x="124.613" y="65.506" font-style="italic">policy checks</tspan></text></g><g id="g7692" display="inline" transform="translate(619.375,690)"><rect id="rect7694" width="230" height="17.638" x="10" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7696" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7698" x="124.613" y="65.506" font-style="italic">set nfmark</tspan></text></g><g id="g7700" display="inline" transform="translate(620,668.2628)"><rect id="rect7702" width="250" height="47.638" x="0" y="52.362" fill="none" fill-opacity=".75" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt"/><text font-family="Bitstream Vera Sans" style="text-align:center;line-height:125%" id="text7704" x="124.613" y="65.506" fill="#000" fill-opacity="1" stroke="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1pt" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan7706" x="124.613" y="65.506" font-style="italic">if packet is ESP or AH</tspan></text></g></g></svg>